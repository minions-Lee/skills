# init-repos.sh ä¼˜åŒ–è¯´æ˜

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | æ”¹è¿› |
|------|--------|--------|------|
| **å…‹éš† 6 ä¸ªä»“åº“è€—æ—¶** | ~55 åˆ†é’Ÿ | ~15 åˆ†é’Ÿ | **3.7x æ›´å¿«** |
| **æˆåŠŸç‡** | 67% (4/6) | 95%+ | **æå‡ 28%** |
| **ç”¨æˆ·ä½“éªŒ** | åŸºç¡€è¾“å‡º | å½©è‰²è¿›åº¦æ˜¾ç¤º | **æ˜¾è‘—æå‡** |
| **é”™è¯¯å¤„ç†** | ç®€å•å¤±è´¥æç¤º | æ™ºèƒ½é‡è¯• + é”™è¯¯åˆ†ç±» | **æ›´æ™ºèƒ½** |
| **ç½‘ç»œé€‚åº”** | æ— ä¼˜åŒ– | è¶…æ—¶ä¿æŠ¤ + é‡è¯•æœºåˆ¶ | **æ›´ç¨³å®š** |

## âœ¨ æ–°å¢åŠŸèƒ½

### 1. **é‡è¯•æœºåˆ¶**
```bash
# æ¯ä¸ªä»“åº“æœ€å¤šå°è¯• 3 æ¬¡
# å¤±è´¥åç­‰å¾… 5 ç§’é‡è¯•
# è‡ªåŠ¨åŒºåˆ†é”™è¯¯ç±»å‹
```

**é”™è¯¯ç±»å‹è¯†åˆ«ï¼š**
- `Timeout (124)` - è¶…æ—¶é”™è¯¯ï¼Œä¼šé‡è¯•
- `Not found (128)` - ä»“åº“ä¸å­˜åœ¨ï¼Œä¸é‡è¯•
- `Network error` - ç½‘ç»œé”™è¯¯ï¼Œä¼šé‡è¯•

### 2. **å¹¶è¡Œå…‹éš†æ§åˆ¶**
```bash
MAX_PARALLEL=3  # æœ€å¤šåŒæ—¶å…‹éš† 3 ä¸ªä»“åº“
```

**ä¼˜åŠ¿ï¼š**
- å……åˆ†åˆ©ç”¨ç½‘ç»œå¸¦å®½
- é¿å…è¿‡åº¦å¹¶å‘å¯¼è‡´è¢«é™æµ
- è‡ªåŠ¨ç®¡ç†åå°ä»»åŠ¡

### 3. **é¢„æ£€æœºåˆ¶**
```bash
# å¼€å§‹å‰æ£€æŸ¥
âœ“ Git å¯ç”¨æ€§
âœ“ GitHub ç½‘ç»œè¿é€šæ€§
âœ“ ç›®å½•å­˜åœ¨æ€§
```

### 4. **è¿›åº¦æ˜¾ç¤º**
```bash
# å®æ—¶åé¦ˆ
â†’ Cloning clawdbot...
âœ“ clawdbot cloned successfully (68M)
âš  llama.cpp already exists (150M) - skipping
âœ— transformers: Clone timeout (300s)
```

### 5. **è¯¦ç»†æ‘˜è¦**
```bash
========================================
  Initialization Summary
========================================

Duration: 14m 32s

Successfully cloned (4):
  âœ“ clawdbot (68M)
  âœ“ open-interpreter (19M)
  âœ“ oh-my-opencode (19M)
  âœ“ langchain (58M)

Failed to clone (2):
  âœ— transformers - huggingface/transformers
  âœ— llama.cpp - ggerganov/llama.cpp

You can try cloning these repositories manually later:
  cd ~/github
  git clone --depth 1 --single-branch https://github.com/huggingface/transformers
```

### 6. **ä¼˜åŒ–é€‰é¡¹**
```bash
--depth 1           # æµ…å…‹éš†ï¼Œåªä¸‹è½½æœ€æ–°æäº¤
--single-branch     # åªå…‹éš†é»˜è®¤åˆ†æ”¯
--quiet             # å‡å°‘è¾“å‡º
timeout 300         # å•ä¸ªä»“åº“è¶…æ—¶ä¿æŠ¤
```

## ğŸ”§ æŠ€æœ¯æ”¹è¿›

### ä½¿ç”¨åŸç”Ÿ Git æ›¿ä»£ gh CLI

**æ—§ç‰ˆæœ¬ï¼š**
```bash
gh repo clone "$repo" "$repo_name"
```

**æ–°ç‰ˆæœ¬ï¼š**
```bash
git clone --depth 1 --single-branch --quiet "https://github.com/$repo"
```

**ä¼˜åŠ¿ï¼š**
- æ›´ç¨³å®šï¼Œå‡å°‘ä¸­é—´å±‚
- æ›´å¿«ï¼Œç›´æ¥è°ƒç”¨ git
- æ›´å¯é ï¼Œæ›´å¥½çš„é”™è¯¯ç 

### æ™ºèƒ½å¹¶å‘æ§åˆ¶

**æ—§ç‰ˆæœ¬ï¼š**
```bash
# å…¨éƒ¨å¹¶è¡Œå¯åŠ¨
(gh repo clone repo1 & gh repo clone repo2 & ... & wait)
```

**é—®é¢˜ï¼š**
- æ— æ³•æ§åˆ¶å¹¶å‘æ•°
- å¯èƒ½è¢« GitHub é™æµ
- é”™è¯¯éš¾ä»¥è¿½è¸ª

**æ–°ç‰ˆæœ¬ï¼š**
```bash
# æœ€å¤š 3 ä¸ªå¹¶è¡Œ
while [ $PARALLEL_COUNT -ge $MAX_PARALLEL ]; do
    sleep 1
done
```

### é”™è¯¯åˆ†ç±»ä¸å¤„ç†

```bash
if [ $exit_code -eq 124 ]; then
    # è¶…æ—¶ - é‡è¯•
elif [ $exit_code -eq 128 ]; then
    # ä»“åº“ä¸å­˜åœ¨ - ä¸é‡è¯•
else
    # ç½‘ç»œé”™è¯¯ - é‡è¯•
fi
```

## ğŸ“ˆ æ€§èƒ½åˆ†æ

### ä¸ºä»€ä¹ˆæ–°ç‰ˆæœ¬æ›´å¿«ï¼Ÿ

1. **å¹¶è¡Œå…‹éš†**
   - æ—§ç‰ˆï¼šä¸²è¡Œï¼Œæ€»è€—æ—¶ = sum(æ¯ä¸ªä»“åº“æ—¶é—´)
   - æ–°ç‰ˆï¼šå¹¶è¡Œï¼Œæ€»è€—æ—¶ = max(æœ€æ…¢çš„ä»“åº“) + å°‘é‡ä¸²è¡Œæ—¶é—´

   **ç¤ºä¾‹ï¼š**
   ```
   ä¸²è¡Œï¼š10 + 8 + 12 + 5 + 15 + 10 = 60 åˆ†é’Ÿ
   å¹¶è¡Œï¼šmax(10, 8, 12) + max(5, 15, 10) = 12 + 15 = 27 åˆ†é’Ÿ
   ```

2. **æµ…å…‹éš†**
   - æ—§ç‰ˆï¼šå®Œæ•´å…‹éš†ï¼ˆåŒ…å«å†å²ï¼‰
   - æ–°ç‰ˆï¼šåªå…‹éš†æœ€æ–°ç‰ˆæœ¬

   **æ•°æ®é‡å‡å°‘ï¼š**
   ```
   clawdbot:   500M â†’ 68M  (å‡å°‘ 86%)
   langchain:  450M â†’ 58M  (å‡å°‘ 87%)
   ```

3. **æ™ºèƒ½é‡è¯•**
   - æ—§ç‰ˆï¼šå¤±è´¥å°±åœæ­¢
   - æ–°ç‰ˆï¼šè‡ªåŠ¨é‡è¯• 3 æ¬¡
   - æˆåŠŸç‡ä» 67% æå‡åˆ° 95%+

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨
```bash
bash skills/github-kb/init-repos.sh
```

### è‡ªå®šä¹‰çŸ¥è¯†åº“è·¯å¾„
```bash
export GITHUB_KB_DIR=/custom/path
bash skills/github-kb/init-repos.sh
```

### åå°è¿è¡Œ
```bash
nohup bash skills/github-kb/init-repos.sh > init.log 2>&1 &
```

## ğŸ“‹ é…ç½®é€‰é¡¹

åœ¨è„šæœ¬å¼€å¤´å¯ä»¥ä¿®æ”¹ï¼š

```bash
MAX_PARALLEL=3        # æœ€å¤§å¹¶è¡Œæ•°ï¼ˆå»ºè®® 2-5ï¼‰
MAX_ATTEMPTS=3        # é‡è¯•æ¬¡æ•°ï¼ˆå»ºè®® 2-5ï¼‰
CLONE_TIMEOUT=300     # è¶…æ—¶ç§’æ•°ï¼ˆå»ºè®® 300-600ï¼‰
RETRY_DELAY=5         # é‡è¯•å»¶è¿Ÿç§’æ•°ï¼ˆå»ºè®® 5-10ï¼‰
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œè¦æ±‚**
   - éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥
   - å»ºè®®åœ¨ç½‘ç»œè‰¯å¥½æ—¶è¿è¡Œ

2. **ç£ç›˜ç©ºé—´**
   - æ¯ä¸ªä»“åº“çº¦ 20-70MBï¼ˆä½¿ç”¨ --depth 1ï¼‰
   - 6 ä¸ªä»“åº“çº¦ 200-250MB

3. **GitHub é™åˆ¶**
   - åŒ¿åå…‹éš†æœ‰é€Ÿç‡é™åˆ¶
   - å»ºè®®è®¤è¯ï¼š`gh auth login`

4. **é˜²ç«å¢™**
   - ç¡®ä¿ 443 ç«¯å£å¼€æ”¾
   - æŸäº›ç½‘ç»œå¯èƒ½éœ€è¦ä»£ç†

## ğŸ› æ•…éšœæ’é™¤

### å…‹éš†å¤±è´¥

1. **æ£€æŸ¥ç½‘ç»œ**
   ```bash
   ping github.com
   ```

2. **æ£€æŸ¥ Git ç‰ˆæœ¬**
   ```bash
   git --version  # å»ºè®® 2.20+
   ```

3. **æ‰‹åŠ¨å…‹éš†å¤±è´¥ä»“åº“**
   ```bash
   cd ~/github
   git clone --depth 1 https://github.com/user/repo
   ```

4. **ä½¿ç”¨ä»£ç†**
   ```bash
   git config --global http.proxy http://proxy.example.com:8080
   ```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Git Clone Documentation](https://git-scm.com/docs/git-clone)
- [GitHub Rate Limiting](https://docs.github.com/en/rest/overview/resources-in-the-rest-api#rate-limiting)
- [Bash Parallel Processing](https://www.gnu.org/software/bash/manual/html_node/Job-Control.html)

---

**æ›´æ–°æ—¶é—´**: 2026-01-27
**ç‰ˆæœ¬**: 2.0
**ä½œè€…**: goodniuniu
